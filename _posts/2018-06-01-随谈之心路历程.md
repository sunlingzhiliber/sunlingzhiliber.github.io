---
layout:     post
title:      随谈之心路历程
subtitle:   OpenGMS生活学习之路
date:       2018-07-10
author:     Liber Sun
header-img: img/post-basic.jpg
catalog: true
tags:
    - 随谈
---
>2017/06-2018/06
走马上任，就开始CVM了。

# 门户

初始MVC架构：其中view是由HTML控制的，是一种前后端分离开发的模式

- html/js/css
- ajax+@WebServlet
- service
- dao
- MongoDB

# 数据容器

属于后台渲染

- ejs

一个模板语言，帮你利用普通的javascript代码生成HTML页面。可以把它理解成nodejs中的JSP文件。

- nodejs
  - express框架

# Geoserver

- 源码解析
  作为一个JavaWeb程序，毫无疑问也是一样的HTTP请求/处理机制：
  `HTTP请求->Dispatch(配置文件web.xml定义路由映射)->获取request参数(SERVICE,VERSION,REQUEST,PARAMS)->构建service->构建operation->excute，获取result->返回`
  
  Geoserver还有一些额外的东西
  1. spring
     不想解释了，javaWeb的三辆马车之一。本质就是配置文件(applicationContext.xml)声明javaBean，交由Spring容器管理javaBean
  2. I18N(国际化)
     通过配置文件xxx.properties 实现不同语言的国际化
  3. FreeMarker
     模板+数据=输出
  4. GeoTools
     java类库满足OGC操作地理空间数据

- Restful API
  Geoserver提供了大量的Restful风格的API供人调用。具体请查看[官网](http://docs.geoserver.org/latest/en/user/rest/index.html#rest)

- 代码部署
  将编译的war包，放到tomcat中即可运行Geoserver服务器

## 投影问题

EPSG:4326 即WGS84，是经纬度坐标
EPSG:3857 即球体（半径为WGS84的长半轴） + 墨卡托投影，俗称Web墨卡托投影 是平面坐标  (等价于谷歌的900913 以及 esri的102100)

# 爬虫

爬虫就是自动化采集互联网上的数据的程序。
爬虫已经成为了程序员所掌握的基本技能，同时也是进入高级开发不得不涉足的内容，为了一个爬虫程序，你需要在以下的领域有一定的了解：

- 学习任意的一门开发语言
- 学习网页前端脚本语言：html、css、js
- 了解HTTP协议、正则表达式、数据库和代理切换等知识
- 多线程并发抓取、任务调度、消息队列、分布式爬虫、图像识别、键鼠模拟、nosql数据库(高级爬虫)
- 浏览器内核实现(终极爬虫)

## 一个简单的爬虫

1. Http请求(单爬虫或者多爬虫并发抓取) 其中不免要考虑验证问题,和抓取方式-是深度抓取还是广度抓取
2. 数据解析(正则表达式)，数据清洗(入库)
3. 避免封杀
   模拟浏览器、Cookie状态、连接数、代理IP

# yacc/lex

研究自制编程语言的时候，稍稍看了点，并没有深入了解，后期在研究完编译原理之后，在回过来研究他们吧

- lex是一种扫描器，从输入序列中识别标记
- yacc定义了语法规范，对lex识别的标记进行某种操作

# SpringBoot后台

和坤坤一起开发 **地理信息平台** 时使用的Java后台框架。整个项目由AngularJS+SpringBoot+MongoDB实现，前后端分离开发。

# Vue前台+SpringBoot

搭建 **可视化平台** ，因为AngularJS入门成本太高，选择了轻量级的前端框架Vue，结合SpringBoot，实现了一个较为简单的SPA。

# SpringBoot重构

在借鉴网上的SpringBoot项目后，对自己的项目进行重构。

- 引入DTO(Data Transfer Object)  
  POJO往往是一个对象的全部展示，如果全部属性展示到前台，会过于复杂，我们没有必要将真个PO对象传递到客户端，因此引入DTO，对PO进行字段筛选。
>VO 这里要特别思考对象在表示层时的体现，因为目前项目是前后端分离的所以没有引入VO，但是在后端渲染时，是考虑引入VO的  

- Annotation结合AOP
  定义注解SysControl对API进行更细粒度的控制
- 分页查询  

-------------------------
>2018/07~2018/08
心心向往的“封闭”终于来了，一个月的时间，看看能做出个什么明堂。

# 模型封装

`Fvocm`和`裂隙岩溶含水层地下水模型`的封装，按部就班就完成了。

# OpenLayer、Leflet、D3、ThreeJS

研究数据的可视化的时候，顺便回顾一下以前使用过的可视化JS库。

- OpenLayer和Leflet是地理空间数据的可视化，往往是二维的
- D3 是利用HTML、SVG、CSS实现数据的可视化
- ThreeJS 场景的可视化
  由scene，camera，geometry，materail的OpenGL的体系

--------------------------------------------------；

>2018/08~2018/10
感觉学习代码陷入了瓶颈，走入了弯路。

一方面是写了太多的业务代码，大多数都是处于CVM的状态，学到到是技巧，而不是技术。这些技巧就好比一个名字，告诉你你就知道了，网上一搜遍地都是(可怜的是，有些东西是你搜不到的，搜到了你也不会用的)。
另一方面是本来就不是专科出生，基础实在是太过于薄弱了，很多东西都是心有余而力不足。

如果是说要在编程的路上走下去的话，我还是希望能从头打好我的基础。因此：

编程基础是什么呢？就是那些年上过的却没有听过的课，离散数学、算法与数据结构、操作系统、计算机体系和网络结构、编译原理等课程。
哎，难受。还是那么一句老话，早知当初，何必如此。而且最难受的，研究生学习的课程也是泛泛而过的，莫不是到头来，也要重新学习一遍啊。

言归正传， 要对计算机本身，计算机网络，操作系统内核，系统平台，OO编程，程序的性能优化等有更深层次的掌握和认识。 我感觉要分为以下几个部分

- 扎实的计算机专业基础，包括算法和数据结构，操作系统，计算机网络，计算机体系结构和数据库等。
- 扎实的Java编程基础，IO以及多线程
- Linux常用指令和Shell脚本语言
- 精通多线程编程，熟悉分布式,缓存,消息队列等机制；熟悉JVM，包括内存模型、类加载机制以及性能优化
- 精通spring mvc、orm框架（ibatis或hibernate）、模板引擎（velocity）、关系型数据库设计及SQL、非结构数据库
- 面向对象编程、面向切面编程、函数式编程、设计模式
- 中间件
- SOA、Clouds等

![源码分析](https://raw.githubusercontent.com/sunlingzhiliber/imgstore/master/20181210212456.png)

![分布式架构](https://raw.githubusercontent.com/sunlingzhiliber/imgstore/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181210212204.jpg)

![微服务](https://raw.githubusercontent.com/sunlingzhiliber/imgstore/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181210212208.jpg)

![优化](https://raw.githubusercontent.com/sunlingzhiliber/imgstore/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181210212210.jpg)

![并发](https://raw.githubusercontent.com/sunlingzhiliber/imgstore/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181210212213.jpg)

![开发工具](https://raw.githubusercontent.com/sunlingzhiliber/imgstore/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181210212217.jpg)

![实战](https://raw.githubusercontent.com/sunlingzhiliber/imgstore/master/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20181210212219.jpg)

>2018/10~2019/03 迷迷糊糊浑然不知道做了些什么

# GraphQL

新的API的构建方式，由FaceBook就行主导。由于自身的技术栈是有Spring主导的，在项目中为了使用方便，我们可以添加以下的java类库：

```xml
		<dependency>
			<groupId>com.graphql-java-kickstart</groupId>
			<artifactId>graphql-spring-boot-starter</artifactId>
			<version>5.9.0</version>
		</dependency>
		<dependency>
			<groupId>com.graphql-java-kickstart</groupId>
			<artifactId>graphiql-spring-boot-starter</artifactId>
			<version>5.9.0</version>
		</dependency>
		<dependency>
			<groupId>com.graphql-java-kickstart</groupId>
			<artifactId>graphql-java-tools</artifactId>
			<version>5.6.1</version>
		</dependency>
```

`graphql-spring-boot-starter`，涉及到`graphql-java`执行引擎，以及`graphql-spring-boot-starter-webmvc`完成了graphQL接入SpringBoot的功能。
`graphiql-spring-boot-starter`,提供了UI层直接访问GraphQL服务器的功能，类似Swagger与Swagger-UI的关系。
`graphql-java-tools`，更方便的在java环境中使用graphQL。在原生的graphql中，我们为了使用需要进行如下的步骤：

```java
TypeDefinitionRegistry typeRegistry = new SchemaParser().parse(new File("schema.graphqls"));
//未能直接与type对应的字段 定义DataFeatcher
RuntimeWiring runtimeWiring =  RuntimeWiring.newRuntimeWiring()
                              .type(newTypeWiring("Query")//Query定义DataFeatcher
                                       .dataFetcher("bookById", graphQLDataFetchers.getBookByIdDataFetcher()))
                              .type(newTypeWiring("Book")//Book中的author字段需要额外的处理，无法直接使用默认PropertyDataFetcher
                                       .dataFetcher("author", graphQLDataFetchers.getAuthorDataFetcher()))
                              .build();
GraphQLSchema graphQLSchema = new SchemaGenerator().makeExecutableSchema(typeRegistry, runtimeWiring);
GraphQL graphQL= GraphQL.newGraphQL(graphQLSchema).build();
```

而`graphql-java-tools`，为我们简化了其中的步骤

```java
GraphQLSchema graphQLSchema = SchemaParser.newParser()
    .file("schema.graphqls")
    .resolvers(new Query(),new Mutation(),new EntityClassResolver())
    .build()
    .makeExecutableSchema();
```

其中的Query ，Mutation，EntityClassResolver实现了GraphQueryResolver\GraphMutationResolver\GraphQLResolver<EntityClass>。


# 毕业设计

## 2R

所有的`Strict`研究其 使用的 数据集 都应该是 `fully accessible` 。更深的理解就是数据的`可接触、可懂、可用`

这样才能一定程度保证文章的可靠性--通过公开。如果文章及其研究是可靠的话，那么我们(Their peer's)肯定在一定层次上可以进行`Reproducibility`和`repeatability`。

我们不可避免的意识到的一点是，`Public`意味着share和open，这实际上是一种牺牲。

那么别人 为什么愿意将自己的研究`Public`呢？仅仅是使用者的感激 肯定是不够的。

一样的数据 、一样的模型 都会导致不一样的结果？ 那是因为对模型、对数据的使用不同，每个人的认识、处理方法不一致。(模型 along with experiment protolcals、数据、数据处理等知识的确定)

full code  and workflow的分享。

参考文献：

Davies, W.K.D., 1968. The need for replication in human geography: some central place
examples. Tijdschrift voor Economische en Sociale Geographie 59(3): 145. DOI:
10.1111/j.1467-9663.1968.tb01703

Fotheringham, A.S., C. Brunsdon, and M. Charlton, 2002. Geographically Weighted
Regression: The Analysis of Spatially Varying Relationships. Hoboken, NJ: Wiley.
Knoth, C. and D. Nüst, 2017. Reproducibility and practical adoption of GEOBIA with
open-source software in Docker containers. Remote Sensing 9(3): 290. DOI:
10.3390/rs9030290
Konkol, M., C. Kray and M. Pfeiffer, 2019. Computational reproducibility in
geoscientific papers: Insights from a series of studies with geoscientists and a
reproduction study, International Journal of Geographical Information Science
33(2): 408-429. DOI: 10.1080/13658816.2018.1508687
Lanter, D.P., 1991, Design of a lineage-based meta-database for GIS. Cartography and
Geographic Information Systems 18(4): 255-261.
Pexman, P.M. and S.J. Lupker, 1995. Effects of memory load in a word-naming task:
Five failures to replicate. Memory and Cognition 23: 581-95. DOI:
10.3758/BF03197260.
Phillips, J., 2012. Storytelling in Earth sciences: the eight basic plots. Earth Science
Reviews 115(3):153-162. DOI: 10.1016/j.earscirev.2012.09.005
Stark, P.B., 2018. Before reproducibility

replication crisis , 许多的复制先前的发现都失败了。

科学家缺乏相关技巧和工具以确保他们的研究是可克制的。

学术文献不应该只是宣传你的调查结果，还应该是详细的报告，以实现repruduced and replicated。

show me is more important than trust me.

reproducible 是 结果可被repeat 在使用相同的数据和相同的方法。
replicable 是更高层次的科学严谨， 使用不同的数据样本和不同的软件。 同样的方法可否在不同的研究领域中repeate。 是否可以推广到别的地方。


人人都在拥抱`Open`,数据的开放、工具、方法、软件的开放，但是openess并不能保证reproduce 更不用说reply。

the term “preproducible” for research that is described in sufficient detail for someone else to repeat it

A “replication crisis” has received widespread attention across the sciences, but perhaps nowhere as much as in psychology, where numerous attempts to replicate previous findings have failed (see, for example,Pexman and Lupker, 1995).


从geospatial perspective ，
1.即使大多数的地理服务并没有完整的文档，他们也建立成功并获得了信任。
2.要求的数据量大，计算量大，很难找到对应的资源。
3.大多数地理空间研究的软件，都是在一定程度上要求简单易用，用户对其是黑盒子是透明的，这意味着参数的默认值，用户是完全不了解的。
4.地图作为成果表现的首选方法，但不能全面、公开的表达这些成果。

近些年来，一些东西的发展，使`Containerization`称为了可能性， 构建软件，与数据一同打包，能在广泛的平台上重用，并存档以便广泛的访问。

关注：
1.地理空间科学存在哪些形式的复制失败？可以设计一个框架来检测、避免这种失败吗？
In the geospatial sciences it is failure to replicate across space (and time) that is most in need of a formal framework. A clear terminology is helpful, and the concept of weak generalizability clearly has profound implications for the geospatial sciences.
2.那些领域容易出现复制失败？
If we think of research in the geospatial sciences as ranging from the theoretical and conceptual to the technical and statistical, then the danger is clearly most severe in the statistical, in applications of geospatial technology in areas such as remote sensing and the social sciences where it is common practice to test ideas in a few selected areas.
3.那些机制可以用来避免或减少此类失败？
Technical research can do much to add to the tools available for support of R&R, and improved documentation and openness can clearly help
4.是否所有的模型都被期待成在空间上是恒定的？如果不是恒定的，那么对空间分析会有何种影响？
空间异质性原理意味着校准在空间上是不会恒定的。The principle of spatial heterogeneity implies that calibrations will not be constant over space. Moreover under-specification will lead to varying calibrations because missing variables will themselves be spatially heterogeneous. Thus there is a strong argument for weak generalizability, and the further development of place-based techniques.
5.如何加2R 纳入未来的空间软件设计和实施
 Better documentation is perhaps the most pressing need.
6.如何让学生意识到这样的问题
7.如何让人更关注这些问题。 
The editorial review process can be strengthened, and papers published in appropriate journals will certainly help. All of this essentially amounts to raising awareness throughout the geospatial sciences community.

原由：
1.科学能力不足，迫使研究人员take shortcuts、减少 尺寸， 做出有限的假设。
*2.研究人员缺乏激励，被迫强调出版数量而不是质量
3.研究人员在寻找到新发现会无意识的产生偏见
4.不确定性是所有数据、分析、结论的基础，都需要考虑的。

不幸的是 reproducible 和 replicable 在 政治学和经济学中 这两个单词并没有区别。
Daniel's definitions 需要被采纳！及CDP definitions(Claerbout,Donoho and Peng)


|  | reproducible | replicable |
|------------|--------------|---------------|
| researcher | different | different |
| tools | same | similar |
| methods | same | similar |
| data | same | different |
| results | same | corroborating |

reproducible : 不同的研究人员 使用 相同的tools methods data ，结果应该是 identical 相同的。
replicability： 不同的研究人员使用 相似的工具 和方法，但是是不同的数据 ， 结果应该与原始研究是一致的。


 “what can spatial science contribute to R&R?” The landmark Hartshorne-Schaefer debate of the 1950s focused on whether the results of geographic scholarship should be replicable over space—whether the results obtained in one study area should be corroborated in another. 

在化学和物理等学科的研究中 ，因为其并不会受到 空间、时间 的影响，因此更需要考虑 `replicability`.

但是对于地理学家所研究的现象而言，这些现象都是具有地方的独特属性。

现在地理学的研究就是在`replicability`之间进行摇摆，
许多的地理学相关的文献明确的表明了over space 的能力。即使他的结果只能从一个领域中得到验证，其结论在别的领域并没有得到参考。
许多的地理空间分析技术,如GWR 单个模型可以应用于任何空间，只是需要对模型的参数提供足够的多样。


数据 和 code  available is not enough 。 还需要 waht we do with them 就是 分享workflow and use cases
文章 ：Hills et 2015，the importance of data  set provenance of science。
然后  make it virtual  。 `DOI` `containers`

## lighting Talks

Mark Gahegean  rethink the process of  scholarly dissemination。
'executable' journal 不仅仅用于去阅读研究，还要reproduce研究。
[physiomeproject]((physiomeproject.org) is a good example.

Song Gao 提出一些方面会导致lack of replicability：未报告的参数， 未记录的参数、未指明出处的数据 ，没有记录的分类间隔。(参数，detailed doc)

Jason Tullis回顾了David Lanter在1990年代早期的工作(例如，Lanter, 1991)，以及他开发的用于记录数据来源的工具。他指出，Esri的ModelBuilder在很多方面都是早期工作的产物，它在很大程度上提高了可复制性。（统一的封装、workflow）

Shaowen wang, 指出了 Jupyter NoteBooks 对于研究各阶段的追踪和记录的作用。

Jupyter NoteBooks是web应用程序，可以让我们创建并共享代码和文档。它提供了一个环境，你可以在其中记录代码，运行代码，查看结果，可视化数据并在查看输出结果。
这些特性使其成为一款执行端到端数据科学工作流程的便捷工具 ，可以用于数据清理，统计建模，构建和训练机器学习模型，可视化数据以及许多其他用途。
保存和共享你的NoteBook是其最重要的功能。(协作)
[CyberGIS](http://cybergis.cigi.uiuc.edu/cyberGISwiki/doku.php)

Dawn Wright wondered if concern for R&R could be regarded as a game changer in geospatial research. Would it help to make such research more resilient (another “re” word)? Would it help the community to address the threats that are emerging in response to the “replication crisis”?

## discussins

实践的各个方面带来的问题。 软件、数据的多版本、新硬件不兼容老硬件，以及元数据、数据来源方法的不足会导致的大量的未记录、未指明。


## keynote

Esri认为 在地理空间科学中 实验可以以工作流的形势 在工作台中执行。
Arcigs提供了ModelBuilder完成此操作，它允许用户使用指定数据集和操作，并在原则上允许在潜在的数据集上使用相同的过程再现或复制实验，并可以将process导出为xml 或者py 脚本。要求捕获工作流程，和数据来源。同时注意所有的地理空间数据以及方法 模型都受到了不确定性的影响，如果不确定性导致的不可复制 是否可以定义为不可复制。
发布模型构建器流程可以实现R&R的目标。但是构建器 对于新版本的软件，对于其中模块是另一供应商提供的就会产生替换困难。虽然是同一个功能模块，但是会存在很大不同。

数据预处理、 模型分析 不是终点 ，还要考虑 dissemination(container notebook)

workflow 要足够的详细

Stewart Fotheringham
R&R 必然要求一个复杂的技术解决方案，这种复杂性不可避免地会阻碍普通研究人员的兴趣。
与一般信息技术一样，为了被广泛的使用，任何解决R&R难题的解决方案都必须是易于理解和使用。需要充分考虑解决方案带来的cost以及相应的好处。 收益必须超过成本。

## UDX

Schema是一个描述数据的结构化。

Schema还是一种中间件， 比如矢量数据格式，Shapfile 、geojson 、数据库中的数据、csv数据，都可以通过schema进行描述，然后定义 resolve 方法。

          | 文本数据
schema    | 内存数据
          | 数据库
          | API、微服务

体现了 操作+数据的概念 不能分割数据+行为

描述数据支持的操作，定义数据的可操作程度。(resolver)
准确地获取（_schema自描述性质，前端和后端不用通信），并只获取所需的数据（{定义结点}），
收到可预测的结果？？？？（{定义结点}，由自己定义）

问题：
数据量大，复杂 从中只是需要部分信息，
并且如果数据与数据需要进行关联操作，可一次性处理。
大量的数据需求的 差异 而对同一数据源的 关注信息点不同，且需求总是快速变化。

A 各自的处理 |
B 各自的处理 | 同一个数据源
C 各自的处理 |

A |                      |  resolve + 数据源
B |统一的视图     |  udx  |  resolve + 数据源
C |                      |  resolve + 数据源

本质上是推迟延后 处理，工作量对于单个系统并没有减少 但要知道其带来的优点！
GraphQL 抽象出了这些必须的大量预处理工作


1.客户端可以自定义查询语句，通过自定义不仅提高了灵活性，而且服务端只返回客户端所需要的数据，减少网络的开销，提高了性能；

2.服务端收到客户端的请求，首先做类型检查，及时反馈，而且更加安全；


提高：

大师兄：
渐进式传输，引入IT中的技术，数据压缩，LOD method
将语义推理方法导入UDX模型。本文将外部语义库导入UDX模型中，以统一的方式从模型数据中得出不同的结论。虽然UDX模型可以提供一个接口来访问这些语义信息，但是模型数据的语义转换仍然无法进行。应该设计和开发一个简单但有效的接口，以便在UDX模型中导入外部语义推理引擎。

进哥：





Abstract:目前，开放网络上提供了大量的地理分析模型(好多平台)和海量的数据资源（大量的数据中心），
如何把模型和数据结合起来，进行模拟仍然存在挑战性。
数据是模型执行的驱动力，但是往往第三方人在除了demo数据之外，及时在拥有详细的文档的情况下，也无法找到对应的其他数据，第三方人拥有的数据往往是不能直接用于驱动或者链接模型的。
大量的试错成本，
大量的数据预处理成本。 要求可重用的数据处理服务，以便通过Web方便地耦合模型和数据资源，从而减少准备数据和避免重复数据处理工作的困难。
基于UDX，提出了三种映射方法。 分别是重构、映射和可视化处理方法。这三种处理方法都能够通过网络进行调用，所提出的处理服务可以弥合地理分析模型与网络上托管的数据资源之间的差距。
大数据传输的问题
数据安全的问题
更简洁的数据处理方法自动生成。



